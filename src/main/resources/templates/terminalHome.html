<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description"
		content="Sitio externo del Gobierno de la Ciudad de Buenos Aires.">
	<meta name="author" content="Grupo45 - UTN-BA">
	<title>Puntos de Interes</title>
	<link rel="shortcut icon" href="bastrap3/favicon.ico">
	<link rel="apple-touch-icon-precomposed" href="bastrap3/favicon-mobile.png">
	<link rel="stylesheet" href="bastrap3/bootstrap.min.css">
	<link rel="stylesheet" href="bastrap3/bastrap.css">
	<link rel="stylesheet" href="css/style.css">
	<link rel="stylesheet" href="css/markerInfoWindows.css">
	<link rel="stylesheet" href="css/sidebar.css" >
	<link rel="stylesheet" href="css/maps.css" >
	
</head>

<body>
	<header class="navbar navbar-primary navbar-top">
		<div class="container">
			<div class="row">
				<div class="col-md-6 col-sm-6">
					<a class="navbar-brand bac-header" href="index.html">Buenos
						Aires Ciudad</a>
				</div>
				<div class="col-md-6 col-sm-6">
					<h5 class="sub-brand">Puntos de Interes</h5>
				</div>
			</div>
		</div>
	</header>
	<main class="main-container" role="main" style="padding-top: 0px;padding-bottom: 0px;">
		<div class="sidebar-wrapper col-sm-4 col-md-3 sidebar">
	    	<div class="mini-submenu">
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
	    	</div>
			<div class="list-group">
				<div class="sidebar-wrapper-header">
					<h5 style="margin-top: 0px;"> Filtros de Busqueda </h5>
					<span href="#" class="pull-right">
						<span href="#" id="slide-submenu" class="glyphicon glyphicon-remove form-control-feedback"></span>
						<i class="fa fa-times"></i>
					</span>
				</div>	
				<div class="sidebar-wrapper-content">
					<form role="form" action="my_home_page" method="post">
						<div class="checkbox sidebar-wrapper-mode">
							<input id="searchMode" type="checkbox" name="manualMode" value="ON" {{searchModeValue}} >
						</div>
						<div class="advancedFilters">
							<div class="filters poiFilters row shortcut-row">
	
								<ul>
									<li><input type="checkbox" name="cgpFilter" value="ON" {{cgpFilterValue}} > CGP</li> 
									<li><input type="checkbox" name="busStopFilter" value="ON" {{busStopFilterValue}} > Paradas de Colectivo </li>
									<li><input type="checkbox" name="localFilter" value="ON" {{localFilterValue}} > Locales Comerciales </li>
									<li><input type="checkbox" name="bankFilter" value="ON" {{bankFilterValue}} > Sucursales de Banco </li>
								</ul>
							</div>
							<div class="filters">
								<ul>
									{{#accessDisponibilityFilter}}
									<li><input type="checkbox" name="disponibilityFilter" value="ON" {{disponibilityFilterValue}} > Solo disponible </li>
									{{/accessDisponibilityFilter}}
									{{#accessProximityFilter}}
									<li><input type="checkbox" name="proximityFilter" value="ON" {{proximityFilterValue}} > Solo cercanos </li>
									{{/accessProximityFilter}}
								</ul>
							</div>
	
	
						</div>
						<div class="manualFilters">
							{{#accessTagFilter}}
							<div class="form-group">
								<label for="tagFilter">Palabra Clave</label>
								<input id="tagFilter" type="text" name="tagFilter" value= "{{tagFilterValue}}" class="form-control" placeholder="Ingrese una etiqueta">
							</div>
							{{/accessTagFilter}}
						</div>
						<input id="searchButton" class="btn btn-primary" type="submit" value="Buscar"/>
					</form>
				</div> 	
				<div class="sidebar-wrapper-footer"></div>
			</div>        
		</div>
        <div id="googleMap"></div>
	</main>
	
	{{#hasResults}}
		<div id="results" style="display:none">
			<table class="table table-striped table-bordered table-condensed table-responsive">
				<thead>
					<tr>
						<th> POI </th>
						<th> Longitud </th>
						<th> Latitud </th>
						<th> Barrio </th>
						<th> Calle </th>
						<th> Codigo Postal </th>
						<th> Esta Cerca </th>
						<th> Esta Disponible </th>
					</tr>
				</thead>
				<tbody>
					{{#each results}}
						<tr> 
							<td>{{{nombre}}}</td>
							<td>{{longitud}}</td>
							<td>{{latitud}}</td>
							<td>{{barrio}}</td>
							<td>{{calle}}</td>
							<td>{{cp}}</td>
							<td>{{estaCerca}}</td>
							<td>{{estaDisponible}}</td>
						</tr>
					{{~/each}}
				</tbody>
			</table>
		</div>
	{{/hasResults}}
	<footer>
		<div class="footer" style="padding: 0px 0;">
			<div class="container">
				<div class="row">
					<div class="col-md-6 col-sm-6">
						<a class="navbar-brand bac-footer" style="margin-top: 15px;"
							href="http://www.buenosaires.gob.ar" target="_blank">Buenos
							Aires Ciudad</a>
					</div>
					<div class="col-md-6 col-sm-6">
						<div class="sub-brand">
							<p>
								Diseño de Sistemas - UTN - FRBA<br /> <span
									class="text-muted">Grupo 45</span>
							</p>
						</div>
					</div>
				</div>
			</div>
		</div>
	</footer>
	<script src="bastrap3/jquery.min.js"></script>
	<script src="bastrap3/bootstrap.min.js"></script>
	<script src="bastrap3/validator.js"></script> <!-- http://1000hz.github.io/bootstrap-validator -->
	<script src="bootstrapCheckbox/js/bootstrap-checkbox.min.js"></script>
	<script src="js/jquery.validate.min.js"></script>
	<script src="http://maps.googleapis.com/maps/api/js?key=AIzaSyBgvn_2I1NSn8nh8z3e2tgI5RUxktygzuc&sensor=false">
	</script>
	<script src="js/terminalSettings.js"></script>
	<script>
		$(document).ready(function() {
			function removeInfoWindowsFields(className,content){
				//me encargo de remover los campos que no corresponden a className
				$.each(content.find(".modal-body .data-group"), function() {
					if (!($(this).hasClass( className ))){
						$(this).remove();
					}
				});
			};
			var myCenter=new google.maps.LatLng(parseFloat({{latitud}}), parseFloat({{longitud}}));
			function initialize() {
				//configuracion inicial de mi mapa
			  	var mapProp = {
				    center:myCenter,
				    zoom:12,
				    panControl: true,
				    zoomControl: true,
				    mapTypeControl: false,
				    scaleControl: false,
				    streetViewControl: true,
				    overviewMapControl: false,
				    rotateControl: false
			  	};
				
				//creo el mapa y seteo las propiedad
		  		var map=new google.maps.Map(document.getElementById("googleMap"),mapProp);
				
			  	//creo un punto con sus propiedades y animaciones
				var markerCenter=new google.maps.Marker({
					position:myCenter//,
					//animation : google.maps.Animation.BOUNCE
				});
		
				markerCenter.setMap(map);
		
				//creo un popup de informacion
				var infowindow = new google.maps.InfoWindow({
					content : "Usted esta aquí!"
				});
		
				//vinculo el pop up con el punto creado
				infowindow.open(map, markerCenter);
				
				//creo los puntos de los resultados
				{{#hasResults}}
					var poiPosition;
					var poiMarker;
					{{#each results}}
						poiPosition = new google.maps.LatLng(parseFloat({{latitud}}), parseFloat({{longitud}}));
						poiMarker = new google.maps.Marker({
						 	position: poiPosition,
						 	icon: '{{icon}}',
						 	map: map,
						 	title: '{{nombre}}'
						 });
						 poiMarker.addListener('click', function() {
							 new google.maps.InfoWindow({
								 	content: (
								 		'<div class="modal-content {{cssClass}} col-md-4">'+
											'<div class="modal-header">'+
												'<img src="{{icon}}" alt="{{nombre}}" class="img-circle">'+
												'<h4>{{titulo}}</h4>'+
											'</div>'+
											'<div class="modal-body">'+
												'<div class="data-group data-colectivo">'+
												    '<label class="data-value">{{linea}}</label>'+
												'</div>'+
												'<div class="data-group data-cgp data-local data-banco">'+
												    '<label class="data-name">Dirección</label>'+
												    '<label class="data-value">{{direccion}}</label>'+
												'</div>'+
												'<div class="data-group data-cgp">'+
												    '<label class="data-name">Zona</label>'+
												    '<label class="data-value">{{zona}}</label>'+
												'</div>'+
												'<div class="data-group data-cgp">'+
													'<ul>'+
														{{#each servicios}}
															'<li>{{name}}</li>'+
														{{~/each}}
													'</ul>'+
												'</div>'+
												'<div class="data-group data-banco">'+
													'<ul>'+
														{{#each servicios}}
															'<li>{{name}}</li>'+
														{{~/each}}
													'</ul>'+
												'</div>'+
												'<div class="data-group data-local">'+
												    '<label class="data-name">Nombre</label>'+
												    '<label class="data-value">{{nombre}}</label>'+
												'</div>'+
												'<div class="data-group data-local">'+
												    '<label class="data-name">Rubro</label>'+
												    '<label class="data-value">{{rubro}}</label>'+
												'</div>'+
											'</div>'+
										'</div>'		
								 	)
								 }).open(map, this);
							 removeInfoWindowsFields("{{cssClass}}",$(".modal-content"));
						 });
					{{~/each}}
				{{/hasResults}}
			}
			google.maps.event.addDomListener(window, 'load', initialize);
		});
	</script>
</body>
</html>